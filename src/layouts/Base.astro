---
import '../styles/global.css';
import Analytics from '@vercel/analytics/astro';

export interface Props {
  title: string;
  description?: string;
  image?: string;
  canonical?: string;
}

const {
  title,
  description = 'Les meilleurs setups home office, chaises ergonomiques, bureaux assis-debout et accessoires pour travailler mieux depuis chez vous.',
  image = '/og-default.jpg',
  canonical,
} = Astro.props;

// FR domain is homeofficesetup.pro ‚Äî hardcoded to avoid using Astro.site (= EN domain)
const FR_BASE = 'https://homeofficesetup.pro';
const EN_BASE = 'https://homeofficesetup.net';
const pagePath = Astro.url.pathname;
const canonicalURL = canonical ?? `${FR_BASE}${pagePath}`;
const hreflangEN = `${EN_BASE}${pagePath}`;
const siteTitle = title === 'Home' ? 'HomeOfficeSetup.pro ‚Äî Setup Productif, Tested & Reviewed'
                 : `${title} ‚Äî HomeOfficeSetup.pro`;
---

<!doctype html>
<html lang="fr" class="scroll-smooth">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="generator" content={Astro.generator} />

  <!-- SEO -->
  <title>{siteTitle}</title>
  <meta name="description" content={description} />
  <link rel="canonical" href={canonicalURL} />

  <!-- Hreflang ‚Äî FR/EN cross-domain -->
  <link rel="alternate" hreflang="fr" href={canonicalURL} />
  <link rel="alternate" hreflang="en" href={hreflangEN} />
  <link rel="alternate" hreflang="x-default" href={hreflangEN} />

  <!-- Open Graph -->
  <meta property="og:title" content={siteTitle} />
  <meta property="og:description" content={description} />
  <meta property="og:image" content={`${FR_BASE}${image}`} />
  <meta property="og:url" content={canonicalURL} />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="fr_FR" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content={siteTitle} />
  <meta name="twitter:description" content={description} />
  <meta name="twitter:image" content={`${FR_BASE}${image}`} />

  <!-- Favicon -->
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />

  <!-- Pinterest -->
  <meta name="p:domain_verify" content="YOUR_PINTEREST_VERIFY_CODE" />

  <!-- Vercel Analytics ‚Äî free, GDPR compliant, no cookies, no banner needed -->
  <Analytics />

  <!-- JSON-LD Site -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "HomeOfficeSetup.pro",
    "url": "https://homeofficesetup.pro",
    "description": "Guide d'achat home office : setups, chaises ergonomiques, bureaux assis-debout et accessoires test√©s et compar√©s.",
    "potentialAction": {
      "@type": "SearchAction",
      "target": "https://homeofficesetup.pro/search?q={search_term_string}",
      "query-input": "required name=search_term_string"
    }
  }
  </script>
</head>

<body class="min-h-screen flex flex-col">

  <!-- ‚îÄ‚îÄ Navigation ‚îÄ‚îÄ -->
  <header class="sticky top-0 z-50 bg-cream/90 backdrop-blur-md border-b border-oak-100">
    <nav class="max-w-6xl mx-auto px-4 sm:px-6 h-16 flex items-center justify-between gap-6">

      <!-- Logo -->
      <a href="/" class="flex items-center gap-2 shrink-0">
        <span class="w-8 h-8 rounded-lg bg-electric flex items-center justify-center text-white font-display font-bold text-sm">HO</span>
        <span class="font-display font-semibold text-ink hidden sm:block">HomeOffice<span class="text-electric">.</span>pro</span>
      </a>

      <!-- Nav links -->
      <ul class="hidden md:flex items-center gap-1 text-sm font-medium">
        <li><a href="/best-standing-desks" class="px-3 py-2 rounded-lg text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Bureaux debout</a></li>
        <li><a href="/best-ergonomic-chairs" class="px-3 py-2 rounded-lg text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Chaises ergo</a></li>
        <li><a href="/best-monitors-home-office" class="px-3 py-2 rounded-lg text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Moniteurs</a></li>
        <li><a href="/budget-home-office-setup" class="px-3 py-2 rounded-lg text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Budget</a></li>
        <li><a href="/guides" class="px-3 py-2 rounded-lg text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Guides</a></li>
      </ul>

      <!-- CTA -->
      <div class="flex items-center gap-3 shrink-0">
        <a href="/home-office-setup" class="btn-secondary hidden sm:inline-flex text-xs py-2 px-4">
          Mon setup ‚Üí
        </a>
        <!-- Mobile menu button -->
        <button id="mobile-menu-btn" class="md:hidden p-2 rounded-lg hover:bg-oak-100 transition-colors" aria-label="Menu">
          <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </nav>

    <!-- Mobile menu -->
    <div id="mobile-menu" class="hidden md:hidden border-t border-oak-100 bg-cream">
      <div class="max-w-6xl mx-auto px-4 py-3 flex flex-col gap-1">
        <a href="/best-standing-desks" class="px-3 py-2.5 rounded-lg text-sm font-medium text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Bureaux debout</a>
        <a href="/best-ergonomic-chairs" class="px-3 py-2.5 rounded-lg text-sm font-medium text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Chaises ergonomiques</a>
        <a href="/best-monitors-home-office" class="px-3 py-2.5 rounded-lg text-sm font-medium text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Moniteurs</a>
        <a href="/budget-home-office-setup" class="px-3 py-2.5 rounded-lg text-sm font-medium text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Setup budget</a>
        <a href="/guides" class="px-3 py-2.5 rounded-lg text-sm font-medium text-ink-muted hover:text-ink hover:bg-oak-100 transition-all">Guides</a>
      </div>
    </div>
  </header>

  <!-- ‚îÄ‚îÄ Main Content ‚îÄ‚îÄ -->
  <main class="flex-1">
    <slot />
  </main>

  <!-- ‚îÄ‚îÄ Footer ‚îÄ‚îÄ -->
  <footer class="bg-ink text-cream/70 mt-24">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 py-16">
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-10">

        <!-- Brand -->
        <div class="lg:col-span-1">
          <div class="flex items-center gap-2 mb-4">
            <span class="w-8 h-8 rounded-lg bg-electric flex items-center justify-center text-white font-display font-bold text-sm">HO</span>
            <span class="font-display font-semibold text-cream">HomeOffice<span class="text-electric">.</span>pro</span>
          </div>
          <p class="text-sm leading-relaxed mb-4">
            Guides d'achat ind√©pendants pour construire le home office parfait. Test√©s, compar√©s, mis √† jour chaque semaine.
          </p>
          <div class="flex gap-3">
            <a href="https://fr.pinterest.com/zerozeroalcool/" class="p-2 rounded-lg bg-white/5 hover:bg-white/10 transition-colors" aria-label="Pinterest">
              <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24"><path d="M12 0C5.373 0 0 5.373 0 12c0 5.084 3.163 9.426 7.627 11.174-.105-.949-.2-2.405.042-3.441.218-.937 1.407-5.965 1.407-5.965s-.359-.719-.359-1.782c0-1.668.967-2.914 2.171-2.914 1.023 0 1.518.769 1.518 1.69 0 1.029-.655 2.568-.994 3.995-.283 1.194.599 2.169 1.777 2.169 2.133 0 3.772-2.249 3.772-5.495 0-2.873-2.064-4.882-5.012-4.882-3.414 0-5.418 2.561-5.418 5.207 0 1.031.397 2.138.893 2.738.098.119.112.224.083.345l-.333 1.36c-.053.22-.174.267-.402.161-1.499-.698-2.436-2.889-2.436-4.649 0-3.785 2.75-7.262 7.929-7.262 4.163 0 7.398 2.967 7.398 6.931 0 4.136-2.607 7.464-6.227 7.464-1.216 0-2.359-.632-2.75-1.378l-.748 2.853c-.271 1.043-1.002 2.35-1.492 3.146C9.57 23.812 10.763 24 12 24c6.627 0 12-5.373 12-12S18.627 0 12 0z"/></svg>
            </a>
          </div>
        </div>

        <!-- Cat√©gories -->
        <div>
          <h4 class="text-cream font-display font-semibold text-sm mb-4 tracking-wide uppercase">Cat√©gories</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="/best-standing-desks" class="hover:text-cream transition-colors">Bureaux assis-debout</a></li>
            <li><a href="/best-ergonomic-chairs" class="hover:text-cream transition-colors">Chaises ergonomiques</a></li>
            <li><a href="/best-monitors-home-office" class="hover:text-cream transition-colors">Moniteurs</a></li>
            <li><a href="/best-webcams-home-office" class="hover:text-cream transition-colors">Webcams</a></li>
            <li><a href="/best-desk-lamps" class="hover:text-cream transition-colors">√âclairage bureau</a></li>
            <li><a href="/best-headsets-home-office" class="hover:text-cream transition-colors">Casques audio</a></li>
          </ul>
        </div>

        <!-- Guides -->
        <div>
          <h4 class="text-cream font-display font-semibold text-sm mb-4 tracking-wide uppercase">Guides</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="/budget-home-office-setup" class="hover:text-cream transition-colors">Setup budget &lt; 500‚Ç¨</a></li>
            <li><a href="/home-office-setup" class="hover:text-cream transition-colors">Guide complet setup</a></li>
            <li><a href="/guides/ergonomie-bureau" class="hover:text-cream transition-colors">Ergonomie au bureau</a></li>
            <li><a href="/guides/lumiere-naturelle" class="hover:text-cream transition-colors">Optimiser l'√©clairage</a></li>
          </ul>
        </div>

        <!-- L√©gal -->
        <div>
          <h4 class="text-cream font-display font-semibold text-sm mb-4 tracking-wide uppercase">√Ä propos</h4>
          <ul class="space-y-2 text-sm mb-4">
            <li><a href="/about" class="hover:text-cream transition-colors">Notre m√©thode</a></li>
            <li><a href="/affiliate-disclosure" class="hover:text-cream transition-colors">Divulgation affili√©</a></li>
            <li><a href="/privacy" class="hover:text-cream transition-colors">Confidentialit√©</a></li>
          </ul>
          <p class="text-xs leading-relaxed">
            En tant que partenaire Amazon Associates, nous percevons une commission sur les achats √©ligibles, sans co√ªt suppl√©mentaire pour vous.
          </p>
        </div>
      </div>

      <div class="border-t border-white/10 mt-12 pt-6 flex flex-col sm:flex-row items-center justify-between gap-4 text-xs">
        <p>¬© {new Date().getFullYear()} HomeOfficeSetup.pro ‚Äî Tous droits r√©serv√©s</p>
        <p class="text-cream/40">Mis √† jour chaque semaine ¬∑ Made with ‚òï & ü§ñ</p>
      </div>
    </div>
  </footer>

  <!-- Mobile menu JS + Plausible custom events -->
  <script>
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    btn?.addEventListener('click', () => menu?.classList.toggle('hidden'));

    // Amazon affiliate click tracking ‚Üí Vercel Analytics custom event
    document.addEventListener('click', function(e) {
      const el = e.target.closest('[data-track="amazon"]');
      if (el && typeof window.va !== 'undefined') {
        window.va('event', {
          name: 'Amazon Click',
          data: {
            asin:    el.dataset.asin  || '',
            product: el.dataset.name  || '',
            price:   el.dataset.price || '',
          }
        });
      }
    });

    // Animate on scroll
    const observer = new IntersectionObserver((entries) => {
      entries.forEach(e => { if (e.isIntersecting) e.target.classList.add('is-visible'); });
    }, { threshold: 0.1 });
    document.querySelectorAll('.animate-on-scroll').forEach(el => observer.observe(el));
  </script>
</body>
</html>
